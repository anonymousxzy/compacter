cuda codes are from https://github.com/HazyResearch/structured-nets
